<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="theme-color" content="#1da1f2">
	<title>CryptBot Malware Report |  MalScope </title>
	<meta name="description"
		content="Background CryptBot is an Info-Stealer malware that has been making its rounds this year, 2022, distributed via cracked software and sketchy websites.">
	<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_001.jpg"/>

<meta name="twitter:title" content="CryptBot Malware Report"/>
<meta name="twitter:description" content="Background CryptBot is an Info-Stealer malware that has been making its rounds this year, 2022, distributed via cracked software and sketchy websites."/>

	<meta name="twitter:site" content="@ByridianBlack" />
	<meta itemprop="name" content="CryptBot Malware Report">
<meta itemprop="description" content="Background CryptBot is an Info-Stealer malware that has been making its rounds this year, 2022, distributed via cracked software and sketchy websites.">
<meta itemprop="datePublished" content="2022-10-05T10:22:10&#43;07:00" />
<meta itemprop="dateModified" content="2022-10-05T10:22:10&#43;07:00" />
<meta itemprop="wordCount" content="757">
<meta itemprop="image" content="https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_001.jpg">



<meta itemprop="keywords" content="CryptBot,Unpacking,API HASHING," />
	<link rel="stylesheet" href="/css/bundle.min.css">
	<link rel="apple-touch-icon" sizes="180x180" href="https://malscope.com/icons/apple-touch-icon.png">
	<link rel="icon" type="image/png" sizes="32x32" href="https://malscope.com/icons/favicon-32x32.png">
	<link rel="icon" type="image/png" sizes="16x16" href="https://malscope.com/icons/favicon-16x16.png">
	<link rel="shortcut icon" href="https://malscope.com/icons/favicon.ico" type="image/x-icon">
	<link rel="icon" href="https://malscope.com/icons/favicon.ico" type="image/x-icon">
	<meta name="msapplication-TileColor" content="#8dc153">
	<link rel="manifest" href="https://malscope.com/manifest.json">
	
	<script type="application/ld+json">
{
	"@context":"http://schema.org",
	"@type":"WebSite",
	"name":"MalScope",
	"url":"https:\/\/malscope.com",
	"sameAs":[
		"https://twitter.com/ByridianBlack",
		"https://gitlab.com/",
		"https://linkedin.com/in/",
		"https://t.me/"
		],
	"potentialAction": {
		"@type": "SearchAction",
		"target": "https://wisnuwiry.space/search?q={search_term}",
		"query-input": "required name=search_term"
	}
}
</script>

<script type='application/ld+json'>
{
	"@context": "http://www.schema.org",
	"@type": "person",
	"name": "ByridianBlack",
	"jobTitle": "Cybersecurity Analyst",
	"gender": "",
	"url": "https:\/\/malscope.com",
	"sameAs":[
		"https://twitter.com/ByridianBlack",
		"https://gitlab.com/",
		"https://linkedin.com/in/",
		"https://t.me/"
		],
	"image": "https:\/\/malscope.com\/img\/avatar.jpg",
	"address": {
		"@type": "PostalAddress",
		"streetAddress": "Mayong, Jepara",
		"addressLocality": "Jepara",
		"addressRegion": "Jawa Tengah",
		"addressCountry": "Indonesia"
	},
	"email": "byridianblack@malscope.com",
	"birthDate": "2003-01-31",
	"birthPlace": "Jepara",
	"nationality": "Indonesian"
}
</script>

<script type="application/ld+json">
{
	"@context":"http://schema.org",
	"@type":"BlogPosting",
	"mainEntityOfPage":{
		"@type":"WebPage",
		"@id":"https:\/\/malscope.comhttps:\/\/malscope.com\/post\/cryptbot-malware-report\/"
	},
	"headline":"CryptBot Malware Report",
	"datePublished":"2022-10-05T10",
	"dateModified":"2022-10-05T10",
	"description":"Background CryptBot is an Info-Stealer malware that has been making its rounds this year, 2022, distributed via cracked software and sketchy websites.",
	"isFamilyFriendly": "true",
	"image":  ["https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_001.jpg"] ,
	"wordCount" : "757",
	"keywords": ["CryptBot","Unpacking","API HASHING"],
	"genre": ["CryptBot","Unpacking","API HASHING"],
	"accountablePerson": {
		"@type": "Person",
		"name": "ByridianBlack",
		"url": ""
	},
	"author": {
		"@type": "Person",
		"name": "ByridianBlack",
		"url": ""
	},
	"creator": {
		"@type": "Person",
		"name": "ByridianBlack",
		"url": ""
	},
	"publisher":{
		"@type":"Organization",
		"name":"ByridianBlack", 
		"logo": {
			"@type": "imageObject",
			"url": "https:\/\/malscope.com\/img\/avatar.jpg"
		}
	}
}</script>


	<meta content="" property="fb:admins">
	<meta content="" property="fb:app_id">
	<meta content="index,follow" name="googlebot">
	<meta content="follow, all" name="Googlebot-Image">
	<meta content="follow, all" name="Scooter">
	<meta content="follow, all" name="msnbot">
	<meta content="follow, all" name="alexabot">
	<meta content="follow, all" name="Slurp">
	<meta content="follow, all" name="ZyBorg">
	<meta content="follow, all" name="Scooter">
	<meta content="true" name="MSSmartTagsPreventParsing">
	<meta content="ALL" name="SPIDERS">
	<meta content="ALL" name="WEBCRAWLERS">
	<meta
		content="aeiwi, alexa, alltheWeb, altavista, aol netfind, anzwers, canada, directhit, euroseek, excite, overture, go, google, hotbot. infomak, kanoodle, lycos, mastersite, national directory, northern light, searchit, simplesearch, Websmostlinked, webtop, what-u-seek, aol, yahoo, webcrawler, infoseek, excite, magellan, looksmart, bing, cnet, googlebot"
		name="search engines">
	
</head>

<body class="">
	<div class="site-container">
		<header class="top" id="js-header">
	<a class="logo" href="/" title="MalScope">
    <img src="/img/placeholder.svg" alt="MalScope" class="lazyload" data-src="/img/avatar.jpg">
</a>
	
	<nav class="navbar js-navbar">
		<ul class="navbar__menu">
			
			
				
				<li>
					<a href="/post" target="_self">
						 Post
					</a>
				</li>
				
				
				<li>
					<a href="/about" target="_self">
						 About
					</a>
				</li>
				
				
				<li>
					<a href="/contact" target="_self">
						 Contact
					</a>
				</li>
				
				
		</ul>
		<button class="navbar__toggle js-toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle-box"><span class="navbar__toggle-inner">Menu</span></span>
		</button>
	</nav>
	<div class="search">
	<a class="search__btn btn" aria-label="Search" href="/search" title="Search">
		<svg viewBox="0 0 15 15">
<path d="M14.81,13.14l-3-3h0a6.52,6.52,0,1,0-1.67,1.67h0l3,3a1.06,1.06,0,0,0,1.43-.24A1.06,1.06,0,0,0,14.81,13.14ZM6.5,11A4.5,4.5,0,1,1,11,6.5,4.51,4.51,0,0,1,6.5,11Z"/>
</svg>

	</a>
	<button class="search__btn large" aria-label="Switch Theme" id="toggle-theme">
		<svg viewBox="0 0 24 24">
			<path id="icon-theme"></path>
		</svg>
	</button>
</div>
</header>

		<main>
			
<div class="hero">
	


<figure class="hero__image hero__image--overlay">
	<img class="hero__image-img lazyload" data-src="https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_001.jpg" src="/img/placeholder.svg" alt="CryptBot Malware Report"/>
</figure>


	<header class="hero__content" >
	<div class="wrapper">
		<h1 itemprop="name"  style="color: white;" >
	
		CryptBot Malware Report
	
		</h1>
	
		</div>
	</header>
</div>

	
	<div class="progress-container" >
    <div class="scroll-indicator-bar" id="indicator"></div>
</div>

	<div class="content  grid ">
		
<aside class="tableOfContentContainer" id="tableOfContentContainer">
	<nav id="TableOfContents">
  <ul>
    <li><a href="#background">Background</a></li>
    <li><a href="#stage-1">Stage 1</a>
      <ul>
        <li><a href="#anti-debugging">Anti-Debugging</a></li>
        <li><a href="#api-hashing">API Hashing</a></li>
      </ul>
    </li>
    <li><a href="#final-stage-executable">Final Stage Executable</a>
      <ul>
        <li><a href="#api-hashing-1">API Hashing</a></li>
        <li><a href="#string-encryption">String Encryption</a></li>
        <li><a href="#targeted-crypto-wallets-password-managers-and-authentication">Targeted Crypto Wallets, Password Managers and Authentication</a></li>
        <li><a href="#contacted-urls">Contacted URLs</a></li>
      </ul>
    </li>
    <li><a href="#conclusion">Conclusion</a>
      <ul>
        <li><a href="#edited-by-elizabeth-laub">Edited by Elizabeth Laub</a></li>
      </ul>
    </li>
  </ul>
</nav>
</aside>
<script>
    window.addEventListener('DOMContentLoaded', () => {
        enableStickyToc();
    });
</script>

		<div class="wrapper post__entry">
			<div class='property outline'>
    <p>üìÖÔ∏è Published: 
        <time itemprop="datePublished" datetime="2022-10-05T10:22:10&#43;07:00">October 05, 2022</time>
    </p>
    <p>üîÑ Updated: 
        <time itemprop="dateModified" datetime="2022-10-05T10:22:10&#43;07:00">October 05, 2022</time>
    </p>
    <p>üïî 4 min read ‚àô 757 words</p></div>
			
<nav class="breadcrumb block" aria-label="breadcrumb">
	<ol class="breadcrumb__list">
		
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/">Home</a> &nbsp;
		</li>
		<li class="breadcrumb__item">
			<a class="breadcrumbs__link" href="/post/">Post üìù</a> &nbsp;
		</li>
		<li class="breadcrumbs__item breadcrumb__item--active" aria-current="page">CryptBot Malware Report</li>
	</ol>
</nav>
			<div class="single block">
				<article class="entry" id="article">
					<div class="entry__content">
					<p><figure class="post__image">
	<img 
	itemprop="image"
	class="lazyload post__image" 
    data-sizes="auto"
    src="/img/placeholder.svg"
    data-src='https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_001.jpg'
    alt='image'
     title="image"
 	/>
</figure>
</p>
<h2 id="background">Background</h2>
<p>CryptBot is an Info-Stealer malware that has been making its rounds this year, 2022, distributed via cracked software and sketchy websites. Its capabilities range from stealing browser credentials, cookies, and cryptocurrency wallets, and enumerating system information sent to its C2 Server.</p>
<p>As reported by Mandiant, the group UNC3512 is currently using the bot to steal sensitive information with capabilities of taking screenshots, cookie and password stealing, and crypto wallet money stealing. Mandiant also claims that this bot has also been tied to installing additional botnets; <strong>DANABOT</strong> <a href="https://experience.mandiant.com/trending-evil-2/p/1">Mandiant Trending Threats</a>.</p>
<p>This analysis aims to confirm previous findings, report tactics and techniques that were formerly undocumented and contribute this new information to the cybersecurity industry.</p>
<h2 id="stage-1">Stage 1</h2>
<p><strong>Sha256</strong>: <strong>af0403b7c12d7b7fa9c487eb4a6e68705e9247abf7bc542f77168bd4ed3408fb</strong></p>
<h3 id="anti-debugging">Anti-Debugging</h3>
<p><figure class="post__image">
	<img 
	itemprop="image"
	class="lazyload post__image" 
    data-sizes="auto"
    src="/img/placeholder.svg"
    data-src='https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_004.png'
    alt='image'
     title="image"
 	/>
</figure>
</p>
<p>Using the PEB structure to determine if the sample is being debugged. It causes an exception if it is. This can be bypassed by using the x64dbg feature <strong>Hide Debugger</strong>.</p>
<h3 id="api-hashing">API Hashing</h3>
<p>Obfuscation through API hashing. From my analysis, I found that the hashing algorithm was just an offshoot of an already discovered hashing algorithm. It differs by adding 10 to the end to make automatic hashing lookup slower. It‚Äôs possible that as CryptBot evolves, it will produce different algorithms by just adding additional values to the hash result.</p>
<p><figure class="post__image">
	<img 
	itemprop="image"
	class="lazyload post__image" 
    data-sizes="auto"
    src="/img/placeholder.svg"
    data-src='https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_005.png'
    alt='image'
     title="image"
 	/>
</figure>
</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="err">#</span> <span class="nx">Round</span> <span class="nx">roate</span> <span class="nx">functions</span><span class="p">:</span>
<span class="err">#</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//gist.github.com/trietptm/5cd60ed6add5adad6a34098ce255949a
</span><span class="c1"></span>
<span class="nx">rol</span> <span class="p">=</span> <span class="nx">lambda</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">r_bits</span><span class="p">,</span> <span class="nx">max_bits</span><span class="p">:</span> \
    <span class="p">(</span><span class="nx">val</span> <span class="o">&lt;&lt;</span> <span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">|</span> \
    <span class="p">((</span><span class="nx">val</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="nx">max_bits</span><span class="o">-</span><span class="p">(</span><span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">)))</span>
 
<span class="nx">ror</span> <span class="p">=</span> <span class="nx">lambda</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">r_bits</span><span class="p">,</span> <span class="nx">max_bits</span><span class="p">:</span> \
    <span class="p">((</span><span class="nx">val</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">)</span> <span class="p">|</span> \
    <span class="p">(</span><span class="nx">val</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="nx">max_bits</span><span class="o">-</span><span class="p">(</span><span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="err">#</span> <span class="nx">Original</span> <span class="nx">Work</span>
<span class="nx">def</span> <span class="nf">hash</span><span class="p">(</span><span class="nx">function_name</span><span class="p">):</span>
    
    <span class="nx">GENERATED_HASH</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="nx">character</span> <span class="nx">in</span> <span class="nx">function_name</span><span class="p">:</span>
        
        <span class="nx">segment_1</span> <span class="p">=</span> <span class="nf">ror</span><span class="p">(</span><span class="nx">GENERATED_HASH</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="nx">segment_2</span> <span class="p">=</span> <span class="nf">ord</span><span class="p">(</span><span class="nx">character</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">segment_2</span> <span class="o">&gt;=</span> <span class="mi">97</span><span class="p">:</span>
            <span class="nx">segment_2</span> <span class="o">-=</span> <span class="mi">32</span>
        <span class="nx">GENERATED_HASH</span> <span class="p">=</span> <span class="nx">segment_1</span> <span class="o">+</span> <span class="nx">segment_2</span>
    <span class="k">return</span> <span class="nx">GENERATED_HASH</span></code></pre></div>
<p>VirtualAlloc, resolved from API hashing, allocated space for the encrypted data, all of which is XOR encrypted. The two buffers produced consist of stage 2 shellcode and the final stage CryptBot executable. For the rest of the analysis, I will be focusing on the final stage executable.</p>
<h2 id="final-stage-executable">Final Stage Executable</h2>
<p><strong>Sha256</strong>: <strong>f158d132733c7bc9f696a2b626f1324e868030513c12dae8d1273c7c841ad899</strong></p>
<h3 id="api-hashing-1">API Hashing</h3>
<p>This stage relies heavily on API hashing to resolve most of its essential APIs, such as <strong>InternetOpenA</strong>, <strong>RegQueryValueA</strong>, and <strong>RegOpenKeyA</strong>. The hashing algorithm was not included in <a href="https://github.com/OALabs/hashdb">HashDB</a>and is a new incorporation that I have named <strong>cryptbot_ror13_add_10</strong>.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="err">#</span> <span class="nx">Round</span> <span class="nx">roate</span> <span class="nx">functions</span><span class="p">:</span>
<span class="err">#</span> <span class="nx">https</span><span class="p">:</span><span class="c1">//gist.github.com/trietptm/5cd60ed6add5adad6a34098ce255949a
</span><span class="c1"></span>
<span class="nx">rol</span> <span class="p">=</span> <span class="nx">lambda</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">r_bits</span><span class="p">,</span> <span class="nx">max_bits</span><span class="p">:</span> \
    <span class="p">(</span><span class="nx">val</span> <span class="o">&lt;&lt;</span> <span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="p">|</span> \
    <span class="p">((</span><span class="nx">val</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="p">(</span><span class="nx">max_bits</span><span class="o">-</span><span class="p">(</span><span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">)))</span>
 
<span class="nx">ror</span> <span class="p">=</span> <span class="nx">lambda</span> <span class="nx">val</span><span class="p">,</span> <span class="nx">r_bits</span><span class="p">,</span> <span class="nx">max_bits</span><span class="p">:</span> \
    <span class="p">((</span><span class="nx">val</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">&gt;&gt;</span> <span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">)</span> <span class="p">|</span> \
    <span class="p">(</span><span class="nx">val</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="nx">max_bits</span><span class="o">-</span><span class="p">(</span><span class="nx">r_bits</span><span class="o">%</span><span class="nx">max_bits</span><span class="p">))</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="nx">max_bits</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

<span class="err">#</span> <span class="nx">Original</span> <span class="nx">Work</span>
<span class="nx">def</span> <span class="nf">hash</span><span class="p">(</span><span class="nx">function_name</span><span class="p">):</span>
    
    <span class="nx">GENERATED_HASH</span> <span class="p">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="nx">character</span> <span class="nx">in</span> <span class="nx">function_name</span><span class="p">:</span>
        
        <span class="nx">segment_1</span> <span class="p">=</span> <span class="nf">ror</span><span class="p">(</span><span class="nx">GENERATED_HASH</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="nx">segment_2</span> <span class="p">=</span> <span class="nf">ord</span><span class="p">(</span><span class="nx">character</span><span class="p">)</span>
        <span class="k">if</span> <span class="nx">segment_2</span> <span class="o">&gt;=</span> <span class="mi">97</span><span class="p">:</span>
            <span class="nx">segment_2</span> <span class="o">-=</span> <span class="mi">32</span>
        <span class="nx">GENERATED_HASH</span> <span class="p">=</span> <span class="nx">segment_1</span> <span class="o">+</span> <span class="nx">segment_2</span>
    <span class="k">return</span> <span class="nx">GENERATED_HASH</span> <span class="o">+</span> <span class="mi">10</span></code></pre></div>
<h3 id="string-encryption">String Encryption</h3>
<p>In the .rdata section there isa long list of encrypted strings, in the following format:</p>
<ul>
<li>First Byte - Data Length</li>
<li>Next 5 Bytes - XOR Key</li>
<li>Rest of Bytes - Encrypted Data</li>
</ul>
<p>The contents of these strings are path strings for browsers, wallets, crypto wallet browser extensions and IDs. It‚Äôs tedious to decrypt these manually, so I created an IDA Script to handle the decryption.</p>
<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="err">#</span><span class="nx">MAIN</span> <span class="nx">FUNCTION</span> <span class="nx">TO</span> <span class="nx">BE</span> <span class="nx">USED</span>
<span class="nx">def</span> <span class="nf">string_decryption_ida_v2</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">):</span>
    
    
    <span class="nx">while</span> <span class="nx">start</span> <span class="p">&lt;</span> <span class="nx">end</span><span class="p">:</span>
        
        <span class="nx">encrypted_string_size</span> <span class="p">=</span> <span class="nf">get_item_size</span><span class="p">(</span><span class="nx">start</span><span class="p">)</span>
        <span class="nf">string_decryption_ida</span><span class="p">(</span><span class="nx">start</span><span class="p">)</span>
        <span class="nx">start</span> <span class="o">+=</span> <span class="nx">encrypted_string_size</span>
        
        
<span class="err">#</span><span class="nx">HELPER</span> <span class="nx">FUNCTION</span>
<span class="nx">def</span> <span class="nf">replace_data</span><span class="p">(</span><span class="nx">ea</span><span class="p">,</span> <span class="nx">new_string</span><span class="p">,</span> <span class="nx">offset</span><span class="p">):</span>
    <span class="nx">ea_start</span> <span class="p">=</span> <span class="nx">ea</span>
    <span class="k">for</span> <span class="nx">s</span> <span class="nx">in</span> <span class="nx">new_string</span><span class="p">:</span>
        <span class="nf">patch_byte</span><span class="p">(</span><span class="nx">ea</span><span class="p">,</span> <span class="nf">ord</span><span class="p">(</span><span class="nx">s</span><span class="p">))</span>
        <span class="nx">ea</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nx">while</span> <span class="nx">ea</span> <span class="p">&lt;</span> <span class="nx">ea_start</span><span class="o">+</span><span class="nx">offset</span><span class="p">:</span>
        <span class="nf">patch_byte</span><span class="p">(</span><span class="nx">ea</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nx">ea</span><span class="o">+=</span><span class="mi">1</span>
    <span class="nf">create_strlit</span><span class="p">(</span><span class="nx">ea_start</span><span class="p">,</span> <span class="nx">idc</span><span class="p">.</span><span class="nx">BADADDR</span><span class="p">)</span>    

<span class="err">#</span><span class="nx">HELPER</span> <span class="nx">FUNCTION</span>
<span class="nx">def</span> <span class="nf">string_decryption_ida</span><span class="p">(</span><span class="nx">ea</span><span class="p">):</span>
    
    <span class="nx">item_size</span> <span class="p">=</span> <span class="nf">get_item_size</span><span class="p">(</span><span class="nx">ea</span><span class="p">)</span>
    <span class="nx">original_ea</span> <span class="p">=</span> <span class="nx">ea</span>
    <span class="nx">data_size</span> <span class="p">=</span> <span class="nf">get_bytes</span><span class="p">(</span><span class="nx">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="nx">data_size</span> <span class="p">=</span> <span class="kt">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="nx">data_size</span><span class="p">,</span> <span class="nx">byteorder</span><span class="p">=</span><span class="err">&#39;</span><span class="nx">big</span><span class="err">&#39;</span><span class="p">)</span>
    
    <span class="nx">ea</span> <span class="p">=</span> <span class="nx">ea</span><span class="o">+</span><span class="mi">1</span>
    <span class="nx">xor_key</span> <span class="p">=</span> <span class="nf">get_bytes</span><span class="p">(</span><span class="nx">ea</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="nx">ea</span> <span class="p">=</span> <span class="nx">ea</span><span class="o">+</span><span class="mi">5</span>
    
    <span class="nx">output</span> <span class="p">=</span> <span class="p">[]</span>
    
    <span class="nx">counter</span> <span class="p">=</span> <span class="mi">0</span>
    
    <span class="nx">while</span> <span class="nx">counter</span> <span class="p">&lt;</span> <span class="nx">data_size</span><span class="p">:</span>
        
        <span class="nx">encrypted_byte</span> <span class="p">=</span> <span class="nf">get_bytes</span><span class="p">(</span><span class="nx">ea</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="nx">output</span><span class="p">.</span><span class="nb">append</span><span class="p">(</span><span class="nf">chr</span><span class="p">(</span><span class="nx">encrypted_byte</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">^</span> <span class="nx">xor_key</span><span class="p">[</span><span class="nx">counter</span> <span class="o">%</span> <span class="mi">5</span><span class="p">]))</span>
        <span class="nx">counter</span><span class="o">+=</span><span class="mi">1</span>
        <span class="nx">ea</span> <span class="p">=</span> <span class="nx">ea</span><span class="o">+</span><span class="mi">1</span>
    <span class="nx">data</span> <span class="p">=</span> <span class="s">&#34;&#34;</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="nx">output</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
    <span class="nf">replace_data</span><span class="p">(</span><span class="nx">original_ea</span><span class="p">,</span> <span class="nx">data</span><span class="p">,</span> <span class="nx">item_size</span><span class="p">)</span></code></pre></div>
<p><figure class="post__image">
	<img 
	itemprop="image"
	class="lazyload post__image" 
    data-sizes="auto"
    src="/img/placeholder.svg"
    data-src='https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_003.png'
    alt='image'
     title="image"
 	/>
</figure>
</p>
<p>Decrypting the strings also revealed SQL queries for credentials and cookie stealing.</p>
<p><figure class="post__image">
	<img 
	itemprop="image"
	class="lazyload post__image" 
    data-sizes="auto"
    src="/img/placeholder.svg"
    data-src='https://raw.githubusercontent.com/ByridianBlack/BlogImages/main/Cryptbot/image_002.png#center'
    alt='image'
     title="image"
 	/>
</figure>
</p>
<p>They also showed capabilities to steal system statistics and capabilities</p>
<h3 id="targeted-crypto-wallets-password-managers-and-authentication">Targeted Crypto Wallets, Password Managers and Authentication</h3>
<table>
  <tr>
    <th><b>Name</b></th>
    <th><b>ID</b></th>
  </tr>
  <tr>
    <td>Guarda</td>
    <td>hpglfhgfnhbgpjdenjgmdgoeiappafln</td>
  </tr>
  <tr>
    <td>Coin98</td>
    <td>aeachknmefphepccionboohckonoeemg</td>
  </tr>
  <tr>
    <td>Math</td>
    <td>afbcbjpbpfadlkmhmclhkeeodmamcflc</td>
  </tr>
    <tr>
    <td>TronLink</td>
    <td>ibnejdfjmmkpcnlpebklmnkoeoihofec</td>
  </tr>
    <tr>
    <td>Keplr</td>
    <td>dmkamcknogkgcdfhhbddcghachkejeap</td>
  </tr>
    <tr>
    <td>Tezos</td>
    <td>ookjlbkiijinhpmnjffcofjonbfbgaoc</td>
  </tr>
    <tr>
    <td>Atomic</td>
    <td>fhilaheimglignddkjgofkcbgekhenbh</td>
  </tr>
    <tr>
    <td>Yoroi</td>
    <td>ffnbelfdoeiohenkjibnmadjiehjhajb</td>
  </tr>
    <tr>
    <td>Jaxx</td>
    <td>cjelfplplebdjjenllpjcblmjkfcffne</td>
  </tr>
    <tr>
    <td>EOS_Authenticator</td>
    <td>oeljdldpnmdbchonielidgobddffflal</td>
  </tr>
  <tr>
    <td>Gauth_Authenticator</td>
    <td>ilgcnhelpchnceeipipijaljkblbcobl</td>
  </tr>
  <tr>
    <td>Trezor_Password_Manager</td>
    <td>imloifkgjagghnncjkhggdhalmcnfklk</td>
  </tr>
  <tr>
    <td>TRUST</td>
    <td>egjidjbpglichdcondbcbdnbeeppgdp</td>
  </tr>
  <tr>
    <td>metamask</td>
    <td>ejbalbakoplchlghecdalmeeeajnimhm</td>
  </tr>
  <tr>
    <td>Mask Wallet</td>
    <td>dfeccadlilpndjjohbjdblepmjeahlmm</td>
  </tr>
  <tr>
    <td>Yoroi</td>
    <td>akoiaibnepcedcplijmiamnaigbepmcb</td>
  </tr>
  <tr>
    <td>JAXX Wallet</td>
    <td>dmdimapfghaakeibppbfeokhgoikeoci</td>
  </tr>
</table>
<h3 id="contacted-urls">Contacted URLs</h3>
<ul>
<li>dixuip12.top</li>
<li>luedil01.top</li>
</ul>
<p>As the creation of this report both URLs are dead</p>
<h2 id="conclusion">Conclusion</h2>
<p>My work confirms previous tactics and techniques documented about the CryptBot malware. It also provides insight into their hashing algorithms and how their implementation slows automatic static analysis. CryptBot, while a standard bot stealer, appears to be very effective because of its prevalence.</p>
<h3 id="edited-by-elizabeth-laub">Edited by Elizabeth Laub</h3>
<ul>
<li><a href="https://www.linkedin.com/in/elizabeth-laub-941465224/">Linkedin</a></li>
<li><a href="https://github.com/Lizoot">Instagram</a></li>
</ul>

					
    <hr>
    <p> <a href="post/CryptBot%20Malware%20Report.md">Edit on Github</a>.</p>
    <hr>

					

					

					</div>
					
					<footer class="entry__footer">
						
<div class="post__tag">
			<a href="/tags/cryptbot/"># CryptBot</a>
			<a href="/tags/unpacking/"># Unpacking</a>
			<a href="/tags/api-hashing/"># API HASHING</a>
</div>
						
<div class="post__share">
	<a class="js-share btn" title=" Facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fmalscope.com%2fpost%2fcryptbot-malware-report%2f" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, ' Facebook', 'width=800,height=600,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Facebook" role="img" width="32" height="32" viewBox="0 0 512 512"><path d="M330 512V322h64l9-74h-73v-47c0-22 6-36 37-36h39V99c-7-1-30-3-57-3-57 0-95 34-95 98v54h-64v74h64v190z"/></svg>
	</a>
	<a class="js-share btn" title=" Twitter" href="https://twitter.com/intent/tweet/?url=https%3a%2f%2fmalscope.com%2fpost%2fcryptbot-malware-report%2f&amp;text=CryptBot%20Malware%20Report" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, ' Twitter', 'width=800,height=450,resizable=yes,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="Twitter" viewBox="0 0 24.999 20.316"><path d="M25 2.405a10.253 10.253 0 0 1-2.947.808A5.144 5.144 0 0 0 24.308.376 10.27 10.27 0 0 1 21.05 1.62a5.134 5.134 0 0 0-8.74 4.68A14.56 14.56 0 0 1 1.74.94a5.134 5.134 0 0 0 1.587 6.846 5.108 5.108 0 0 1-2.323-.642v.064a5.132 5.132 0 0 0 4.114 5.03 5.142 5.142 0 0 1-2.316.088 5.134 5.134 0 0 0 4.79 3.562 10.29 10.29 0 0 1-6.37 2.2A10.44 10.44 0 0 1 0 18.012a14.586 14.586 0 0 0 22.454-12.29q0-.333-.015-.662A10.423 10.423 0 0 0 25 2.405z" /></svg>

	</a>
	<a class="js-share btn" title=" LinkedIn" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2fmalscope.com%2fpost%2fcryptbot-malware-report%2f&title=CryptBot%20Malware%20Report" target="_blank" rel="noopener noreferrer" onclick="window.open(this.href, ' LinkedIn', 'width=640,height=480,toolbar=0,status=0'); return false">
		<svg class="share__icon" aria-label="LinkedIn" role="img" viewBox="0 0 34.48 32"><path d="M29.632,0H2.362A2.336,2.336,0,0,0,0,2.306V29.691A2.337,2.337,0,0,0,2.362,32h27.27A2.342,2.342,0,0,0,32,29.691V2.306A2.34,2.34,0,0,0,29.632,0ZM9.491,27.268H4.744V12H9.491ZM7.119,9.909a2.752,2.752,0,1,1,2.75-2.753A2.753,2.753,0,0,1,7.119,9.909ZM27.268,27.268H22.525V19.842c0-1.772-.033-4.05-2.466-4.05-2.47,0-2.848,1.929-2.848,3.921v7.555H12.468V12h4.553v2.086h.063a4.986,4.986,0,0,1,4.491-2.467c4.806,0,5.694,3.163,5.694,7.275Z"/></svg>

	</a>
</div>
						
<div class="post__bio bio" >
		<img class="lazyload bio__avatar" alt="ByridianBlack avatar" data-src="/img/avatar.jpg" height="90" width="90" src="/img/placeholder.svg">
	<div class="bio__info">
		<a class="bio__name invert" href="/about">
			<p itemprop="author">ByridianBlack</p>
		</a>
		
	</div>
</div>

					</footer>
					
				</article>
				
			</div>
		</div>
	</div>
	



<div class="post__related related">
	<div class="wrapper">
		<h2 class="h5 related__title">You should also read:</h2>
		
		<article class="related__item">
			<div class="feed__meta">
				
	<time itemprop="datePublished" class="feed__date" datetime="2022-09-27T10:22:10&#43;07:00">September 27, 2022</time>
			</div>
			<h3><a class="invert" href="/post/smokeloader-unpacking/">SmokeLoader Unpacking Series</a></h3></article>
		
	</div>
</div>

	
<section class="post__comments">
	<div class="wrapper">
		<h5>üí¨ Comment: </h5>
		<div id="comment"></div>
		
	</div>
	<script>
		var commentId = document.getElementById('comment');
		var commentLoaded = false;
		window.addEventListener('scroll', loadComment());

		function loadComment(){
			window.addEventListener('DOMContentLoaded', () => {
				var top = commentId.offsetTop;
				
				if (!commentLoaded) {
					commentLoaded = true;
					(function () {
						var d = document, s = d.createElement('script');
						s.src = 'https://utteranc.es/client.js';
						s.setAttribute('repo', '');
						s.setAttribute('issue-term', 'title');
						var currentTheme = localStorage.getItem("w-theme");
						if(currentTheme == 'light'){
							s.setAttribute('theme', 'github-light');
						}else{
							s.setAttribute('theme', 'photon-dark');
						}
						s.setAttribute('crossorigin', 'anonymous');
						s.async = !0;
						commentId.appendChild(s);
					})();
				}
			});		
		}
	</script>
</section>

	

		</main>
		<footer class="footer">
<div class="footer__social">
		<a itemprop="sameAs" class="social__link" target="_blank" rel="noopener noreferrer" href="https://twitter.com/ByridianBlack">
			<svg class="social__icon" aria-label="Twitter" viewBox="0 0 24.999 20.316"><path d="M25 2.405a10.253 10.253 0 0 1-2.947.808A5.144 5.144 0 0 0 24.308.376 10.27 10.27 0 0 1 21.05 1.62a5.134 5.134 0 0 0-8.74 4.68A14.56 14.56 0 0 1 1.74.94a5.134 5.134 0 0 0 1.587 6.846 5.108 5.108 0 0 1-2.323-.642v.064a5.132 5.132 0 0 0 4.114 5.03 5.142 5.142 0 0 1-2.316.088 5.134 5.134 0 0 0 4.79 3.562 10.29 10.29 0 0 1-6.37 2.2A10.44 10.44 0 0 1 0 18.012a14.586 14.586 0 0 0 22.454-12.29q0-.333-.015-.662A10.423 10.423 0 0 0 25 2.405z" /></svg>

		</a>
		<a itemprop="sameAs" class="social__link" target="_blank" rel="noopener noreferrer" href="https://github.com/ByridianBlack">
			<svg class="social__icon" aria-label="Github" role="img" viewBox="0 0 25 25"><path d="m12 .5c-6.63 0-12 5.28-12 11.792 0 5.211 3.438 9.63 8.205 11.188.6.111.82-.254.82-.567 0-.28-.01-1.022-.015-2.005-3.338.711-4.042-1.582-4.042-1.582-.546-1.361-1.335-1.725-1.335-1.725-1.087-.731.084-.716.084-.716 1.205.082 1.838 1.215 1.838 1.215 1.07 1.803 2.809 1.282 3.495.981.108-.763.417-1.282.76-1.577-2.665-.295-5.466-1.309-5.466-5.827 0-1.287.465-2.339 1.235-3.164-.135-.298-.54-1.497.105-3.121 0 0 1.005-.316 3.3 1.209.96-.262 1.98-.392 3-.398 1.02.006 2.04.136 3 .398 2.28-1.525 3.285-1.209 3.285-1.209.645 1.624.24 2.823.12 3.121.765.825 1.23 1.877 1.23 3.164 0 4.53-2.805 5.527-5.475 5.817.42.354.81 1.077.81 2.182 0 1.578-.015 2.846-.015 3.229 0 .309.21.678.825.56 4.801-1.548 8.236-5.97 8.236-11.173 0-6.512-5.373-11.792-12-11.792z" /></svg>

		</a>
</div>
	
</footer>
	</div>
	



<script type="text/javascript" src="/js/bundle.min.js" defer></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.2.0/lazysizes.min.js"></script>
<script>(function (d, e) { d[e] = d[e].replace("no-js", "js"); })(document.documentElement, "className");</script>
<script>
    

    if ('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('/sw.js', { scope: '/' })
            .then(function (registration) {
                console.log('Service Worker Registered');
            });

        navigator.serviceWorker
            .ready
            .then(function (registration) {
                console.log('Service Worker Ready');
            });
    }
</script>

</body>

</html>
